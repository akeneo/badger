{% extends 'GateBundle::base-admin.html.twig' %}

{% block body %}
    <div class="ui basic segment">
        <div class="ui large breadcrumb">
            <a class="section" href="{{ path('admin') }}">Admin</a>
            <div class="divider"> / </div>
            <a class="section" href="{{ path('admin_configuration_index') }}">Configuration</a>
            <div class="divider"> / </div>
            <div class="active section">
                {% if configuration.id == null %}
                    Create
                {% else %}
                    Edit configuration "{{ configuration.code }}"
                {% endif %}
            </div>
        </div>
    </div>

    {{ form_start(form, { 'attr': {'class': 'ui form'} }) }}
    {{ form_errors(form) }}

    <div class="ui segments">
        <div class="ui segment">
            {{ form_widget(form) }}
        </div>
        <div class="ui secondary clearing segment">
            <button class="ui green labeled icon button" type="submit"><i class="save icon"></i> Save</button>
        </div>
    </div>

    {{ form_end(form) }}
{% endblock %}

{% block javascripts %}
    <script>
        $(document).ready(function() {
            $('#configuration_title').on('input', function () {
                var title = $('#configuration_title').val();
                // Credits: http://stackoverflow.com/questions/11815883/convert-non-ascii-characters-umlauts-accents-to-their-closest-ascii-equiva
                var code = title.normalize('NFKD').toLowerCase()
                        .replace(/[\u0300-\u036F]/g, '')
                        .replace(/[^\w\s-]/g, '') // remove non-word [a-z0-9_], non-whitespace, non-hyphen characters
                        .replace(/[\s_-]+/g, '-') // swap any length of whitespace, underscore, hyphen characters with a single -
                        .replace(/^-+|-+$/g, ''); // remove leading, trailing -

                $('#configuration_code').val(code);
            });
        });
    </script>
{% endblock %}
