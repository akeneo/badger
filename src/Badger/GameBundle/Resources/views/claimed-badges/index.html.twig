{% extends 'GateBundle::base-admin.html.twig' %}

{% block body %}
    <div class="ui basic segment">
        <div class="ui large breadcrumb">
            <a class="section" href="{{ path('admin') }}">Admin</a>
            <div class="divider"> /</div>
            <a class="section" href="{{ path('admin_badge_index') }}">Badges</a>
            <div class="divider"> /</div>
            <div class="active section">Pending claims</div>
        </div>
    </div>

    {% for flash_message in app.session.flashbag.get('notice') %}
        <div class="ui icon positive message">
            <i class="checkmark icon"></i>
            <div class="content">
                <p>{{ flash_message }}</p>
            </div>
        </div>
    {% endfor %}

    {% for flash_message in app.session.flashbag.get('error') %}
        <div class="ui icon error message">
            <i class="warning sign icon"></i>
            <div class="content">
                <p>{{ flash_message }}</p>
            </div>
        </div>
    {% endfor %}

    {% if claimedBadges is not empty %}
    <table class="ui celled padded table">
        <thead>
        <tr><th class="single line">User</th>
            <th>Badge</th>
            <th>Claimed date</th>
            <th>Proof</th>
            <th>Accept that claim?</th>
        </tr></thead>
        <tbody>
        {% for claimedBadge in claimedBadges %}
        <tr>
            <td>
                <img class="ui avatar image" src="{{ claimedBadge.user.profilePicture }}">
                <span>{{ claimedBadge.user.username }}</span>
            </td>
            <td class="single line">
                <img class="ui avatar image" src="{{ claimedBadge.badge.imageWebPath }}">
                <span class="popup" data-title="{{ claimedBadge.badge.title }}" data-content="{{ claimedBadge.badge.description }}">{{ claimedBadge.badge.title }}</span>
            </td>
            <td>
                {{ claimedBadge.claimedDate|date("d/m/Y") }}
            </td>
            <td>
                <p>{{ claimedBadge.proof|nl2br }}</p>
            </td>
            <td class="center aligned">
                <div class="ui tiny buttons">
                    <a href="{{ url('admin_claimed_badge_accept', { 'id': claimedBadge.id }) }}" class="ui positive button">Hell yes!</a>
                    <div class="or"></div>
                    <a href="{{ url('admin_claimed_badge_reject', { 'id': claimedBadge.id }) }}" class="ui red button">Nope.</a>
                </div>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
        <div class="ui center aligned padded secondary segment">
            <p><i class="icon thumbs outline up"></i> No claim, no pain.</p>
        </div>
    {% endif %}
{% endblock %}

{% block javascripts %}
    <script>
        $('.popup').popup();
    </script>
{% endblock %}
